(this["webpackJsonpnursery-ui"]=this["webpackJsonpnursery-ui"]||[]).push([[0],{105:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(25),l=n.n(c),u=(n(80),n(81),n(7)),o=n(13),i=n.n(o),s=n(29),m=n(12),d=n(21),p=(n(83),n(10)),v=n(22),f=n(37),b=(n(86),n(36));n(95);function E(){var e=Object(d.a)(["\nmutation verifyToken($token:String!){\n    verifyToken(token:$token){\n      payload\n    }\n  }\n"]);return E=function(){return e},e}function g(){var e=Object(d.a)(["\nmutation createUser($username:String!,$password:String!) {\n    createUser(input: {\n      username:$username\n      password:$password\n    }) {\n      ok\n    }\n  }\n"]);return g=function(){return e},e}function h(){var e=Object(d.a)(["\nmutation tokenAuth($username:String!,$password:String!){\n    tokenAuth(username:$username ,password:$password){\n      token\n    }\n  }"]);return h=function(){return e},e}function O(){var e=Object(d.a)(["\nmutation removePlant($username:String!,$plantId:Int!) {\n    removePlant(username:$username,plantId:$plantId){\n      ok\n    }\n  }\n"]);return O=function(){return e},e}function j(){var e=Object(d.a)(["mutation removeCart($username:String!,$plantId:Int!) {\n    removeCart(username:$username,plantId:$plantId){\n      ok\n    }\n  }\n"]);return j=function(){return e},e}function k(){var e=Object(d.a)(["\nmutation orderPlant($username:String!,$plantId:Int!) {\n    orderPlant(username:$username,plantId:$plantId){\n      ok\n    }\n  }\n"]);return k=function(){return e},e}function y(){var e=Object(d.a)(["\nmutation addToCart($username:String!,$plantId:Int!) {\n    addToCart(username:$username,plantId:$plantId){\n      ok\n    }\n  }\n"]);return y=function(){return e},e}function w(){var e=Object(d.a)(["\nquery {\n\tplants {\n    id\n    name\n    price\n    description\n    photo\n  }\n}\n"]);return w=function(){return e},e}function I(){var e=Object(d.a)(["\nmutation createPlant($name:String!,$price:Int!,$description:String!) {\n    createPlant(name:$name,price:$price,description:$description){\n      ok\n    }\n  }\n"]);return I=function(){return e},e}function S(){var e=Object(d.a)(["\nquery otherPlants($username:String!){\n    otherPlants(username:$username){\n        id\n        name\n        price\n        description\n        photo\n    }\n  }\n"]);return S=function(){return e},e}function $(){var e=Object(d.a)(["\n\nquery userDetails($username:String!){\n    userDetails(username:$username){\n      isManager\n      orderPlaced {\n        id\n        name\n        price\n        description\n        photo\n      }\n      cart {\n        id\n        name\n        price\n        description\n        photo\n      }\n    }\n  }"]);return $=function(){return e},e}function x(){var e=Object(d.a)(["\n{\n    record {\n      id\n      createdAt\n      orderUser{\n        username\n        \n      }\n      orderPlant {\n        name\n        price\n        description\n      }\n    }\n  }\n"]);return x=function(){return e},e}var P=Object(u.gql)(x()),C=function(){var e=Object(u.useQuery)(P),t=e.loading,n=e.error,a=e.data;return t?r.a.createElement("p",null," Loading "):n?r.a.createElement("p",null," error "):a.record.map((function(e){var t=e.id,n=e.orderPlant,a=e.orderUser,c=e.createdAt;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"main-card",key:t},r.a.createElement("div",{className:"card-record"},r.a.createElement("div",null,r.a.createElement("p",null," Ordered by user : ",r.a.createElement("span",null,a.username)),r.a.createElement("p",null,"Plant Name : ",r.a.createElement("span",null," ",n.name)),r.a.createElement("p",null,"Plant price : ",r.a.createElement("span",null,n.price)," \u20b9"),r.a.createElement("p",null," Plant Description ",r.a.createElement("span",null,n.description)),r.a.createElement("p",null," Created At : ",r.a.createElement("span",null,c))))))}))},N=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{isManager:!1,heading:" \ud83d\udcda Records"}),r.a.createElement(C,null))},q=Object(u.gql)($()),M=Object(u.gql)(S()),A=function(){var e,t=Object(u.useQuery)(q,{variables:{username:localStorage.getItem("username")}}),n=t.data,c=t.refetch,l=Object(u.useQuery)(M,{variables:{username:localStorage.getItem("username")}}),o=l.data,i=l.refetch,s=Object(a.useState)([]),d=Object(m.a)(s,2),p=d[0],v=d[1],f=Object(a.useState)("cart"),b=Object(m.a)(f,2),E=b[0],g=b[1];n&&(e=n.userDetails.isManager);return Object(a.useEffect)((function(){o&&v(o.otherPlants)}),[n]),r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{isManager:!!e,heading:"\ud83c\udf3f Shop Plants"}),r.a.createElement("div",{className:"main-card",key:!0},r.a.createElement("div",{className:"sort-plants"},r.a.createElement("div",null,r.a.createElement("select",{name:"methods",id:"plants",onClick:function(e){i(),c(),"InCart"===e.target.value?(v(n.userDetails.cart),g("cart")):"Buy"===e.target.value?(v(n.userDetails.orderPlaced),g("buy")):"other"===e.target.value?(v(o.otherPlants),g("other")):v([])}},r.a.createElement("option",{value:"other"},"Plants"),r.a.createElement("option",{value:"Buy"}," Plants Buyed "),r.a.createElement("option",{value:"InCart"}," Plants in Cart")))),r.a.createElement(z,{plants:p,method:E})))},L=Object(u.gql)(I()),B=function(e){var t,n,a,c=Object(u.useMutation)(L),l=Object(m.a)(c,1)[0],o=function(){var t=Object(s.a)(i.a.mark((function t(n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.variables,t.prev=1,t.next=4,l({variables:a});case 4:t.sent,v.a.success("Plant created successfully."),e.onHide(),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),v.a.warn("can't create plant"),e.onHide();case 13:setTimeout((function(){window.location.reload()}),200);case 14:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(f.a,Object.assign({},e,{size:"md","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),r.a.createElement(f.a.Header,{closeButton:!0},r.a.createElement(f.a.Title,{id:"contained-modal-title-vcenter"},"Add Plant")),r.a.createElement(f.a.Body,null,r.a.createElement("div",{className:"add-plant"},r.a.createElement("div",null,r.a.createElement("label",null," Name: "),r.a.createElement("input",{ref:function(e){t=e},name:"text",required:!0})),r.a.createElement("div",null,r.a.createElement("label",null," Price: "),r.a.createElement("input",{ref:function(e){n=e},name:"text",type:"number",required:!0})),r.a.createElement("div",null,r.a.createElement("label",null,"Description: "),r.a.createElement("textarea",{required:!0,ref:function(e){a=e}})),r.a.createElement("div",null,r.a.createElement("input",{className:"submit-addplant",type:"submit",onClick:function(e){e.preventDefault(),o({variables:{name:t.value,price:n.value,description:a.value}}),t.value="",a.value="",n.value=""}})))))},D=function(){var e=Object(p.e)();return r.a.createElement(b.Menu,{id:"menu_id"},r.a.createElement(b.Item,{onClick:function(t){e.push("/records/")}},"Records"),r.a.createElement(b.Item,{onClick:function(){localStorage.removeItem("username"),localStorage.removeItem("token"),setTimeout((function(){window.location.reload()}),100)}},"Logout"))},T=function(e){var t=e.isManager,n=e.heading,a=r.a.useState(!1),c=Object(m.a)(a,2),l=c[0],u=c[1],o=Object(p.e)(),i=localStorage.getItem("token")?localStorage.getItem("username"):"  ";return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header"},r.a.createElement("h4",null,"Dphi Nursery"),r.a.createElement(b.MenuProvider,{id:"menu_id",event:"onClick",style:{margin:"1rem"}},r.a.createElement("p",null,i,r.a.createElement(D,null)))),r.a.createElement("section",{className:"menu"},r.a.createElement("div",null," ",r.a.createElement("p",{style:{fontSize:"20px"}},n),"  "),t?r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return u(!0)}}," \u2795 Add Plant"),r.a.createElement(B,{show:l,onHide:function(){return u(!1)}}),r.a.createElement("button",{onClick:function(){return o.push("/records")}}," \ud83d\udcda Records ")):"  "))},F=Object(u.gql)(w()),U=Object(u.gql)(y()),R=Object(u.gql)(k()),H=Object(u.gql)(j()),Q=Object(u.gql)(O()),z=function(e){var t=e.plants,n=e.method,c=Object(u.useQuery)(F),l=c.loading,o=c.error,d=(c.data,Object(u.useMutation)(U)),p=Object(m.a)(d,1)[0],f=Object(u.useMutation)(H),b=Object(m.a)(f,1)[0],E=Object(u.useMutation)(Q),g=Object(m.a)(E,1)[0],h=Object(u.useMutation)(R),O=Object(m.a)(h,1)[0],j=(localStorage.getItem("username"),function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p({variables:{username:localStorage.getItem("username"),plantId:t.target.id}});case 3:e.sent,v.a.success("Plant added to cart"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),v.a.warn("can't add to cart");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()),k=function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O({variables:{username:localStorage.getItem("username"),plantId:t.target.id}});case 3:e.sent,v.a.success("Plant buyed"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),v.a.warn("can't buy plant");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b({variables:{username:localStorage.getItem("username"),plantId:t.target.id}});case 3:e.sent,v.a.success("Plant removed from cart"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),v.a.warn("can't remove plant");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g({variables:{username:localStorage.getItem("username"),plantId:t.target.id}});case 3:e.sent,v.a.success("Plant removed from buying.."),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),v.a.warn("can't remove plant from buying..");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){}),[t,n]),l?r.a.createElement("p",null," Loading .."):o?r.a.createElement("p",null," Error .."):t.map((function(e){var t=e.id,a=e.name,c=e.price,l=e.description;e.photo;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"card",key:t},r.a.createElement("img",{src:"https://picsum.photos/id/1/200/300"}),r.a.createElement("div",null,r.a.createElement("h3",null,a),r.a.createElement("p",null,"price : ",c," \u20b9 "),r.a.createElement("p",null,"description : ",l),r.a.createElement("div",{className:"card-button"},"cart"===n&&"buy"!==n&&"other"!==n?r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{id:t,style:{background:"#a4a19a"},onClick:function(e){y(e)}},"\ud83d\uded2Remove from Cart "),r.a.createElement("a",{id:t,onClick:function(e){k(e)}},"\u2197\ufe0f Buy ")):" ","cart"!==n&&"buy"===n&&"other"!==n?r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{id:t,onClick:function(e){j(e)}},"\ud83d\uded2Add to Cart "),r.a.createElement("a",{id:t,onClick:function(e){w(e)},style:{background:"#a4a19a"}},"\u2197\ufe0f Remove from Buyed ")):" ","cart"!==n&&"buy"!==n&&"other"===n?r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{id:t,onClick:function(e){j(e)}},"\ud83d\uded2Add to Cart "),r.a.createElement("a",{id:t,onClick:function(e){k(e)}},"\u2197\ufe0f Buy ")):" "))))}))},J=Object(u.gql)(h()),W=Object(u.gql)(g()),_=function(){Object(p.e)();var e,t,n,c,l,o=Object(u.useMutation)(J),d=Object(m.a)(o,1)[0],f=Object(u.useMutation)(W),b=Object(m.a)(f,1)[0],E=Object(a.useState)(),g=Object(m.a)(E,2),h=(g[0],g[1]),O=Object(a.useState)(),j=Object(m.a)(O,2),k=j[0],y=j[1],w=Object(a.useState)(!0),I=Object(m.a)(w,2),S=(I[0],I[1]),$=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.variables,e.prev=1,e.next=4,d({variables:n});case 4:a=e.sent,localStorage.setItem("token",a.data.tokenAuth.token),localStorage.setItem("username",n.username),h(a),v.a.success("Logging in..."),setTimeout((function(){window.location.reload()}),100),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),y(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.variables,e.prev=1,e.next=4,b({variables:n});case 4:e.sent,v.a.success(r.a.createElement("div",null,r.a.createElement("b",null,"Account created ;)"),r.a.createElement("div",null,"Now login...."))),setTimeout((function(){window.location.reload()}),100),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),S(!1);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{isManager:!1,heading:" "}),r.a.createElement("div",null,r.a.createElement("div",{className:"login-sign"},r.a.createElement("div",null,r.a.createElement("form",{className:"login-form"},"   ",r.a.createElement("div",null,r.a.createElement("h3",null," Login "),r.a.createElement("p",{className:"error-login"},k?" * Enter valid credentails":" "),r.a.createElement("label",null,"Username: "),r.a.createElement("input",{ref:function(t){e=t},name:"username",type:"text",style:{marginLeft:"13px"}})),r.a.createElement("div",null,r.a.createElement("label",null," Password:  "),r.a.createElement("input",{ref:function(e){t=e},name:"password",type:"password",style:{marginLeft:"16px"}})),r.a.createElement("div",null,r.a.createElement("button",{className:"btns",onClick:function(n){n.preventDefault(),$({variables:{username:e.value,password:t.value}}),e.value="",t.value=""},type:"submit"},"Login")))),r.a.createElement("div",null," ",r.a.createElement("h2",null," Or ")),r.a.createElement("div",null,r.a.createElement("form",null,r.a.createElement("div",{className:"sign-form"},r.a.createElement("h3",{style:{marginTop:"1rem",marginBottom:"1rem",margin:"0"}}," Sign Up"),r.a.createElement("div",null,r.a.createElement("p",{className:"error-login"},x?" ":" * Can't create account"),r.a.createElement("label",null,"Username"),r.a.createElement("input",{ref:function(e){n=e},style:{marginLeft:"65px"}})),r.a.createElement("div",null,r.a.createElement("label",null,"Password"),r.a.createElement("input",{style:{marginLeft:"70px"},ref:function(e){l=e},type:"password"})),r.a.createElement("div",null,r.a.createElement("label",null,"Confirm Password "),r.a.createElement("input",{ref:function(e){c=e},style:{marginLeft:"11px"}})),r.a.createElement("div",null,r.a.createElement("button",{className:"btns",type:"submit",onClick:function(e){e.preventDefault(),x({variables:{username:n.value,password:c.value}}),n.value="",c.value="",l.value=""}},"Sign Up"))))))))},G=Object(u.gql)(E()),K=function(){var e=Object(a.useState)(null),t=Object(m.a)(e,2),n=(t[0],t[1]),c=Object(a.useState)(),l=Object(m.a)(c,2),o=l[0],d=l[1],p=Object(u.useMutation)(G),v=Object(m.a)(p,1)[0],f=Object(a.useState)(localStorage.getItem("token")?localStorage.getItem("token"):null),b=Object(m.a)(f,2),E=b[0],g=b[1],h=function(){var e=Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,g(localStorage.getItem("token")),e.next=5,v({variables:{token:E}});case 5:e.sent,console.log("userLoggedIn"),n(!0),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),n(!1),console.log("Invalid token");case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){E?h():(console.log("user not logged in"),n(!1)),d(!1)}),[]),o?r.a.createElement("p",null," Loading .."):E?r.a.createElement(A,{key:1}):r.a.createElement(_,null)},V=n(49),X=new u.ApolloClient({uri:"http://localhost:8000/graphql/",cache:new u.InMemoryCache});var Y=function(){return r.a.createElement(V.a,null,r.a.createElement(u.ApolloProvider,{client:X},r.a.createElement("div",{className:"App"},r.a.createElement(p.a,{exact:!0,path:"/",component:K}),r.a.createElement(p.a,{path:"/records/",component:N}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},75:function(e,t,n){e.exports=n(105)},80:function(e,t,n){},81:function(e,t,n){},83:function(e,t,n){}},[[75,1,2]]]);
//# sourceMappingURL=main.c102b101.chunk.js.map